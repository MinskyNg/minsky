<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>瀑布流</title><link rel="stylesheet" type="text/css" href="/css/libs/normalize.min.css"><style type="text/css">body{font-family:'Microsoft Yahei',Helvetica,Arial,sans-serif;background:#FAFAFA}h4{padding-bottom:4px;margin:10px 0;border-bottom:1px solid #777}p{margin-bottom:10px;font-size:12px;line-height:1.5;color:#444}li{list-style-type:none}li img{width:100%;height:auto}.wrapper{width:100%}.container{position:relative;margin:0 auto}.item{position:absolute;width:200px;padding:10px;margin:10px 0;border:1px solid #CCC;border-radius:1px;background:#FFF;transition:all .8s linear}.hide{display:none;padding:0 10px;margin:0 10px;border:none}.load{width:6em;height:6em;margin:0 auto;border-radius:50%;font-size:20px;box-shadow:inset 0 0 0 .6em #EAEAEA}.load i{position:absolute;width:6em;height:6em;clip:rect(0,6em,6em,3em);animation:load-circle-clipper 1s infinite ease-in-out}@keyframes load-circle-clipper{0%{transform:rotate(0deg)}100%{transform:rotate(180deg)}}.load i:after{content:'';position:absolute;width:6em;height:6em;border-radius:50%;box-shadow:inset 0 0 0 .6em #555;clip:rect(0,6em,6em,3em);animation:load-circle 1s infinite ease-in-out}@keyframes load-circle{0%{transform:rotate(-180deg)}100%{transform:rotate(180deg)}}</style></head><body><div class="wrapper"><ul class="container"><li class="item hide"></li></ul><div class="load"><i></i></div></div><script src="/js/libs/jquery.min.js"></script><script type="text/javascript">!function(t){function e(){this.timer,this.curPage=1,this.pageCount=10,this.checkShow(),this.render(),t(window).on("resize",this.render.bind(this)),t(window).on("scroll",function(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.checkShow.bind(this),100)}.bind(this))}e.prototype={render:function(){var e=t(".wrapper").width(),i=t(".item").outerWidth(!0),a=new Array(Math.floor(e/i));a.fill(0),t(".item").each(function(){for(var e=t(this),n=0,o=a[0],r=0;r<a.length;r++)a[r]<o&&(o=a[r],n=r);e.css({top:o,left:n*i}),a[n]+=e.outerHeight(!0)}),t(".container").css({height:Math.max.apply(null,a)})},checkShow:function(){t(".load").offset().top<t(window).scrollTop()+t(window).height()&&t.ajax({url:"http://platform.sina.com.cn/slide/album_tech",dataType:"jsonp",jsonp:"jsoncallback",data:{app_key:"1271687855",num:this.pageCount,page:this.curPage}}).done(function(t){t&&t.status&&"0"===t.status.code?(this.renderData(t.data),this.curPage++):console.log("Load Error!")}.bind(this))},renderData:function(e){for(var i=0;i<e.length;i++)t(".container").append(t('<li class="item"><a href="'+e[i].url+'" class="link"><img src="'+e[i].img_url+'" alt=""></a><h4 class="header">'+e[i].short_name+'</h4><p class="desp">'+e[i].short_intro+"</p></li>")).animate(100);t(".item").find("img").on("load",this.render.bind(this))}},window.Waterfall=e}(jQuery);var waterfall=new Waterfall;</script></body></html>
