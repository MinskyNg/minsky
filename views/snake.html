<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>贪吃蛇</title><link rel="stylesheet" type="text/css" href="/css/libs/normalize.min.css"><style type="text/css">#map{position:absolute;left:50%;top:50%;width:600px;height:600px;margin-top:-300px;margin-left:-300px;background:#999;overflow:hidden}#control{position:absolute;left:200px;top:200px}button{color:#fff;background:#999}</style></head><body><div id="control"><button id="start">开始游戏 <span>得分：</span><span id="score"></span></div><div id="map"></div><script type="text/javascript">!function(t,e){function s(t){this.map=t.map,this.button=t.button,this.score=t.score,this.snakeBody=[],this.stepX=20,this.stepY=0,this.moveDir="right",this.timer,this.init()}s.prototype={init:function(){var t=this;e.onkeydown=this.dirControl.bind(this),this.button.onclick=function(){"重新开始"===this.innerHTML&&(t.map.innerHTML="",t.snakeBody=[],t.stepX=20,t.stepY=0,t.moveDir="right",clearTimeout(t.timer));for(var e=2;e>=0;e--)t.initSnake(e);t.snakeMove(),t.touchBound(),t.generateFood(),t.eat(),this.innerHTML="重新开始"}},dirControl:function(t){var e=t||event,s=e.keyCode;switch(s){case 37:if("right"===this.moveDir)break;this.stepX=-20,this.stepY=0,this.moveDir="left",this.reMove();break;case 38:if("down"===this.moveDir)break;this.stepX=0,this.stepY=-20,this.moveDir="up",this.reMove();break;case 39:if("left"===this.moveDir)break;this.stepX=20,this.stepY=0,this.moveDir="right",this.reMove();break;case 40:if("up"===this.moveDir)break;this.stepX=0,this.stepY=20,this.moveDir="down",this.reMove()}},initSnake:function(t){var s=e.createElement("div");s.style.position="absolute",s.style.top="0px",s.style.left=20*t+"px",s.style.background="#383838",s.style.width="20px",s.style.height="20px",this.snakeBody.push(s),this.map.appendChild(s)},snakeMove:function(){for(var t=this.snakeBody.length-1;t>0;t--)this.snakeBody[t].style.left=this.snakeBody[t-1].style.left,this.snakeBody[t].style.top=this.snakeBody[t-1].style.top;this.snakeBody[0].style.left=parseInt(this.snakeBody[0].style.left)+this.stepX+"px",this.snakeBody[0].style.top=parseInt(this.snakeBody[0].style.top)+this.stepY+"px",this.timer=setTimeout(this.snakeMove.bind(this),400)},reMove:function(){clearTimeout(this.timer),this.snakeMove()},touchBound:function(){this.score.innerHTML=this.snakeBody.length-3;var e=parseInt(this.snakeBody[0].style.left),s=parseInt(this.snakeBody[0].style.top);if((0>e||e>580||0>s||s>580)&&(alert("Game Over"),t.location.reload()),this.snakeBody.length>4)for(var i=this.snakeBody.length-1,o=3;i>o;o++){var n=parseInt(this.snakeBody[o].style.left),a=parseInt(this.snakeBody[o].style.top);e===n&&s===a&&(alert("Game Over"),t.location.reload())}setTimeout(this.touchBound.bind(this),30)},generateFood:function(){var t=20*Math.floor(29*Math.random())+"px",s=20*Math.floor(29*Math.random())+"px",i=e.createElement("div");i.style.position="absolute",i.style.top=s,i.style.left=t,i.style.width="20px",i.style.height="20px",i.style.backgroundColor="#fff",i.id="food",this.map.appendChild(i)},eat:function(){var t=parseInt(this.snakeBody[0].style.left),s=parseInt(this.snakeBody[0].style.top),i=e.getElementById("food"),o=parseInt(i.style.left),n=parseInt(i.style.top);Math.abs(t-o)<20&&Math.abs(s-n)<20&&(i.style.backgroundColor="#383838",this.snakeBody.push(i),i.id="",this.generateFood()),setTimeout(this.eat.bind(this),30)}},t.Snake=s}(window,document);var options={map:document.getElementById("map"),button:document.getElementById("start"),score:document.getElementById("score")},snake=new Snake(options);</script></body></html>
