<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Canvas时钟</title><link rel="stylesheet" type="text/css" href="/css/libs/normalize.min.css"><style type="text/css">#clock{display:block;margin:50px auto 0}</style></head><body><canvas id="clock"></canvas><script type="text/javascript">!function(t,i){function s(t){this.canvas=i.getElementById(t.id),this.dia=this.canvas.height=this.canvas.width=2*t.radius,this.radius=t.radius,this.context=this.canvas.getContext("2d"),this.dialColor=t.dialColor,this.hourColor=t.hourColor,this.minColor=t.minColor,this.secColor=t.secColor,this.dialWidth=t.dialWidth,this.degWidth=t.degWidth,this.hourWidth=t.hourWidth,this.minWidth=t.minWidth,this.secWidth=t.secWidth,t.afterDraw instanceof Function&&(this.afterDraw=t.afterDraw),this.d,this.h,this.m,this.s,this.timer,this.draw()}s.prototype={draw:function(){this.context.clearRect(0,0,this.dia,this.dia),this.now(),this.drawDial(),this.drawMinDegree(),this.drawHourDegree(),this.drawCenter(),this.drawHour(),this.drawMin(),this.drawSec(),this.afterDraw&&this.afterDraw(Math.floor(this.h),this.m,this.s),this.timer=setTimeout(this.draw.bind(this),1e3)},now:function(){this.d=new Date,this.h=this.d.getHours(),this.m=this.d.getMinutes(),this.s=this.d.getSeconds(),this.h+=this.m/60,this.h=this.h>12?this.h-12:this.h},drawDial:function(){this.context.beginPath(),this.context.lineWidth=this.dialWidth,this.context.strokeStyle=this.dialColor,this.context.arc(this.radius,this.radius,200,0,360,!1),this.context.closePath(),this.context.stroke()},drawHourDegree:function(){for(var t=0;12>t;t++)this.context.save(),this.context.lineWidth=this.degWidth,this.context.translate(this.radius,this.radius),this.context.rotate(30*t*Math.PI/180),this.context.beginPath(),this.context.moveTo(0,-180),this.context.lineTo(0,-160),this.context.strokeStyle=this.hourColor,this.context.closePath(),this.context.stroke(),this.context.restore()},drawMinDegree:function(){for(var t=0;60>t;t++)this.context.save(),this.context.translate(this.radius,this.radius),this.context.rotate(6*t*Math.PI/180),this.context.beginPath(),this.context.moveTo(0,-180),this.context.lineWidth=this.degWidth,this.context.lineTo(0,-170),this.context.strokeStyle=this.minColor,this.context.closePath(),this.context.stroke(),this.context.restore()},drawCenter:function(){this.context.beginPath(),this.context.arc(this.radius,this.radius,10,0,360,!1),this.context.closePath(),this.context.fill()},drawHour:function(){this.context.save(),this.context.translate(this.radius,this.radius),this.context.rotate(30*this.h*Math.PI/180),this.context.beginPath(),this.context.moveTo(0,-110),this.context.lineTo(0,30),this.context.lineWidth=this.hourWidth,this.context.strokeStyle=this.hourColor,this.context.closePath(),this.context.stroke(),this.context.restore()},drawMin:function(){this.context.save(),this.context.translate(this.radius,this.radius),this.context.rotate(6*this.m*Math.PI/180),this.context.beginPath(),this.context.moveTo(0,-130),this.context.lineWidth=this.minWidth,this.context.lineTo(0,25),this.context.strokeStyle=this.minColor,this.context.closePath(),this.context.stroke(),this.context.restore()},drawSec:function(){this.context.save(),this.context.translate(this.radius,this.radius),this.context.rotate(6*this.s*Math.PI/180),this.context.beginPath(),this.context.moveTo(0,150),this.context.lineWidth=this.secWidth,this.context.strokeStyle=this.secColor,this.context.lineTo(0,-25),this.context.closePath(),this.context.stroke(),this.context.restore()},destroy:function(){clearTimeout(this.timer),this.context.clearRect(0,0,this.dia,this.dia)}},t.Clock=s}(window,document);var options={id:"clock",radius:250,dialColor:"#f1f1f1",hourColor:"#333",minColor:"#999",secColor:"red",dialWidth:20,degWidth:5,hourWidth:9,minWidth:7,secWidth:3,afterDraw:function(t,i,s){console.log(t+":"+i+":"+s)}},clock=new Clock(options);</script></body></html>
